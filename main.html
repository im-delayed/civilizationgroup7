<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì§€êµ¬ ê°œë°œ ì£¼ì‹íšŒì‚¬</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: #222;
            color: #eee;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
        }

        h1 { margin-bottom: 10px; color: #ffd700; text-shadow: 2px 2px #000; }

        /* ê²Œì„ ë³´ë“œ ìŠ¤íƒ€ì¼ (ë¶€ë£¨ë§ˆë¸” í˜•íƒœ) */
        #board {
            display: grid;
            grid-template-columns: repeat(6, 80px);
            grid-gap: 5px;
            margin: 20px;
            background: #333;
            padding: 10px;
            border-radius: 10px;
        }

        .tile {
            width: 80px;
            height: 80px;
            background-color: #444;
            border: 1px solid #555;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 10px;
            text-align: center;
            position: relative;
            cursor: pointer;
        }

        .tile.occupied { border: 3px solid; }

        /* í”Œë ˆì´ì–´ ë§ */
        .player-token {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            position: absolute;
            bottom: 5px;
            box-shadow: 0 0 5px white;
        }

        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        #controls {
            background: #111;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            width: 90%;
            max-width: 500px;
        }

        button {
            background: #d32f2f;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
            font-weight: bold;
        }
        button:hover { background: #b71c1c; }
        button:disabled { background: #555; cursor: not-allowed; }

        /* ëª¨ë‹¬ (ì„ íƒ ì°½) */
        #modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }

        #modal-box {
            background: #222;
            border: 2px solid #d32f2f;
            padding: 30px;
            width: 80%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 0 20px #d32f2f;
        }

        .warning-text {
            color: #d32f2f;
            font-size: 20px;
            font-weight: bold;
            animation: blink 1s infinite;
            margin: 20px 0;
        }

        @keyframes blink { 50% { opacity: 0.5; } }

        .btn-develop {
            background: linear-gradient(45deg, #ffd700, #ff8c00);
            color: #000;
            font-size: 18px;
            padding: 15px 30px;
            border: 2px solid white;
            box-shadow: 0 0 10px yellow;
        }

        .btn-preserve {
            background: #388e3c;
            font-size: 12px;
            padding: 5px 10px;
            margin-top: 20px;
            opacity: 0.7;
        }

        /* ì—”ë”© í™”ë©´ */
        #ending-screen {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: black;
            color: #d32f2f;
            z-index: 200;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
        }
        
        #ending-title { font-size: 40px; margin-bottom: 20px; }
        #ending-message { font-size: 18px; line-height: 1.6; color: #fff; max-width: 600px; }
    </style>
</head>
<body>

    <h1>ğŸŒ ì§€êµ¬ ê°œë°œ ê²½ìŸ</h1>
    
    <div id="controls">
        <h2 id="turn-info">í”Œë ˆì´ì–´ 1ì˜ ì°¨ë¡€ (ë‚¨ì€ í„´: 5)</h2>
        <div id="dice-result" style="margin: 10px; font-size: 24px;">ğŸ² ì¤€ë¹„</div>
        <button id="roll-btn" onclick="rollDice()">ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°</button>
        <div id="score-board" style="margin-top: 15px; display: flex; justify-content: space-around;">
            </div>
    </div>

    <div id="board">
        </div>

    <div id="modal-overlay">
        <div id="modal-box">
            <h2 id="modal-title">ì§€ì—­ ì´ë¦„</h2>
            <p id="modal-desc" style="color:#aaa;">í™˜ê²½ ì„¤ëª…</p>
            <div class="warning-text">âš ï¸ ê²½ê³ : ìƒíƒœê³„ íŒŒê´´ ìœ„í—˜ âš ï¸<br>ê°œë°œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</div>
            <p style="font-size:12px; color: #555;">(ê°œë°œ ì‹œ ìŠ¹ì  +1 íšë“)</p>
            
            <button class="btn-develop" onclick="makeChoice(true)">ë„¤, ê°œë°œí•˜ì—¬ ì´ìµì„ ì–»ìŠµë‹ˆë‹¤.</button>
            <br>
            <button class="btn-preserve" onclick="makeChoice(false)">ì•„ë‹ˆìš”, ë³´ì¡´í•©ë‹ˆë‹¤. (ì ìˆ˜ ì—†ìŒ)</button>
        </div>
    </div>

    <div id="ending-screen">
        <h1 id="ending-title">GAME OVER</h1>
        <div id="ending-message"></div>
        <button onclick="location.reload()" style="margin-top:50px;">ì²˜ìŒìœ¼ë¡œ (ì§€êµ¬ ë¦¬ì…‹)</button>
    </div>

    <script>
        // --- ê²Œì„ ì„¤ì • ë° ë°ì´í„° ---
        const players = [
            { id: 1, name: "P1", color: "#ff5252", pos: 0, score: 0, lands: [] },
            { id: 2, name: "P2", color: "#448aff", pos: 0, score: 0, lands: [] },
            { id: 3, name: "P3", color: "#69f0ae", pos: 0, score: 0, lands: [] },
            { id: 4, name: "P4", color: "#e040fb", pos: 0, score: 0, lands: [] }
        ];
        
        const maxTurns = 5; // ê° í”Œë ˆì´ì–´ ë‹¹ í„´ ìˆ˜
        let currentTurn = 1; // í˜„ì¬ ë¼ìš´ë“œ
        let currentPlayerIdx = 0; // í˜„ì¬ í”Œë ˆì´ì–´ ì¸ë±ìŠ¤ (0~3)
        let totalTurnsPlayed = 0;
        
        // ë§µ ë°ì´í„° (20ì¹¸: 0ì€ ì‹œì‘ì )
        const mapData = [
            { name: "ì¶œë°œ", desc: "ì•ˆì „ì§€ëŒ€", type: "start" },
            { name: "ì•„ë§ˆì¡´", desc: "ì§€êµ¬ì˜ í—ˆíŒŒ. ìˆ˜ì²œ ì¢…ì˜ í¬ê·€ ìƒë¬¼ì´ ì„œì‹ ì¤‘ì…ë‹ˆë‹¤.", type: "land" },
            { name: "ë‚¨ê·¹", desc: "ê±°ëŒ€í•œ ë¹™í•˜. í•´ìˆ˜ë©´ ìƒìŠ¹ì„ ë§‰ê³  ìˆìŠµë‹ˆë‹¤.", type: "land" },
            { name: "ì‚°í˜¸ì´ˆ", desc: "í•´ì–‘ ìƒíƒœê³„ì˜ ë³´ê³ . íŒŒê´´ ì‹œ ë³µêµ¬ ë¶ˆê°€ëŠ¥.", type: "land" },
            { name: "ì„¸ë ê²Œí‹°", desc: "ì•¼ìƒë™ë¬¼ì˜ ë§ˆì§€ë§‰ ë‚™ì›.", type: "land" },
            { name: "ì•Œë˜ìŠ¤ì¹´", desc: "ì˜êµ¬ë™í† ì¸µ. ë©”íƒ„ ê°€ìŠ¤ê°€ ë´‰ì¸ë˜ì–´ ìˆìŠµë‹ˆë‹¤.", type: "land" },
            { name: "ê°ˆë¼íŒŒê³ ìŠ¤", desc: "ì§„í™”ë¡ ì˜ ì‚´ì•„ìˆëŠ” ì¦ê±°.", type: "land" },
            { name: "íˆë§ë¼ì•¼", desc: "ì„¸ê³„ì˜ ì§€ë¶•. ì‹ìˆ˜ì›ì˜ ê·¼ì›ì§€.", type: "land" },
            { name: "íˆ°ë“œë¼", desc: "ì§€êµ¬ ì˜¨ë‚œí™”ì˜ ìµœì „ì„ .", type: "land" },
            { name: "ë³´ë¥´ë„¤ì˜¤", desc: "ì˜¤ë‘ìš°íƒ„ì˜ ë§ˆì§€ë§‰ ì„œì‹ì§€.", type: "land" },
            { name: "ê·¸ë¦°ë€ë“œ", desc: "ë¶ë°˜êµ¬ ê¸°í›„ ì¡°ì ˆì˜ í•µì‹¬.", type: "land" },
            { name: "ë°”ì´ì¹¼í˜¸", desc: "ì„¸ê³„ì—ì„œ ê°€ì¥ ê¹Šê³  ê¹¨ë—í•œ í˜¸ìˆ˜.", type: "land" },
            { name: "ì½©ê³  ë¶„ì§€", desc: "ì•„í”„ë¦¬ì¹´ì˜ ì‹¬ì¥.", type: "land" },
            { name: "ë§ˆë‹¤ê°€ìŠ¤ì¹´ë¥´", desc: "ê³ ìœ ì¢…ì˜ ë³´ë¬¼ì°½ê³ .", type: "land" },
            { name: "ë¶ê·¹í•´", desc: "ë¶ê·¹ê³°ì˜ í„°ì „.", type: "land" },
            { name: "ê·¸ë ˆì´íŠ¸ë°°ë¦¬ì–´ë¦¬í”„", desc: "ì„¸ê³„ ìµœëŒ€ì˜ ì‚°í˜¸ì´ˆ ì§€ëŒ€.", type: "land" },
            { name: "ì˜ë¡œìŠ¤í†¤", desc: "ìµœì´ˆì˜ êµ­ë¦½ê³µì›.", type: "land" },
            { name: "ì‚¬í•˜ë¼", desc: "í™•ì¥ë˜ëŠ” ì‚¬ë§‰í™”ì˜ ê²½ê³„.", type: "land" },
            { name: "ëª°ë””ë¸Œ", desc: "ê°€ë¼ì•‰ê³  ìˆëŠ” ì„¬ë‚˜ë¼.", type: "land" },
            { name: "ìš°ì£¼ ì •ê±°ì¥", desc: "ìµœí›„ì˜ ë„í”¼ì²˜?", type: "land" }
        ];

        const boardState = new Array(mapData.length).fill(null); // ì†Œìœ ì ì •ë³´ ì €ì¥

        // --- ì´ˆê¸°í™” ---
        function initGame() {
            const boardEl = document.getElementById('board');
            boardEl.innerHTML = '';
            
            // ë³´ë“œ UI ìƒì„±
            mapData.forEach((tile, index) => {
                const div = document.createElement('div');
                div.className = 'tile';
                div.id = `tile-${index}`;
                div.innerHTML = `<div>${tile.name}</div>`;
                boardEl.appendChild(div);
            });
            updatePlayerTokens();
            updateScoreBoard();
        }

        // --- í”Œë ˆì´ì–´ í† í° ì—…ë°ì´íŠ¸ ---
        function updatePlayerTokens() {
            // ê¸°ì¡´ í† í° ì œê±°
            document.querySelectorAll('.player-token').forEach(el => el.remove());

            players.forEach(p => {
                const tile = document.getElementById(`tile-${p.pos}`);
                const token = document.createElement('div');
                token.className = 'player-token';
                token.style.backgroundColor = p.color;
                // ê²¹ì¹¨ ë°©ì§€ë¥¼ ìœ„í•´ ì•½ê°„ì”© ìœ„ì¹˜ ì¡°ì •
                token.style.left = `${10 + (p.id * 10)}px`; 
                tile.appendChild(token);
            });
        }

        // --- ì ìˆ˜íŒ ì—…ë°ì´íŠ¸ ---
        function updateScoreBoard() {
            const sb = document.getElementById('score-board');
            sb.innerHTML = players.map(p => 
                `<div style="color:${p.color}">${p.name}: ${p.score}ë•…</div>`
            ).join('');
        }

        // --- ê²Œì„ ë¡œì§: ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸° ---
        function rollDice() {
            const btn = document.getElementById('roll-btn');
            btn.disabled = true;

            const dice = Math.floor(Math.random() * 6) + 1;
            document.getElementById('dice-result').innerText = `ğŸ² ${dice}`;

            // ì´ë™
            const player = players[currentPlayerIdx];
            player.pos = (player.pos + dice) % mapData.length;
            updatePlayerTokens();

            // ë„ì°©í•œ ê³³ í™•ì¸
            const landIndex = player.pos;
            const landInfo = mapData[landIndex];

            setTimeout(() => {
                if (landInfo.type === 'start') {
                    nextTurn();
                } else if (boardState[landIndex] !== null) {
                    alert(`ì´ë¯¸ ${players[boardState[landIndex]-1].name}ì— ì˜í•´ ê°œë°œëœ ì§€ì—­ì…ë‹ˆë‹¤.`);
                    nextTurn();
                } else {
                    // ë¯¸ê°œë°œ ì§€ì—­: ì„ íƒ ëª¨ë‹¬ ë„ìš°ê¸°
                    showChoiceModal(landInfo, landIndex);
                }
            }, 500);
        }

        // --- ì„ íƒ ëª¨ë‹¬ ---
        let currentLandIndex = -1;

        function showChoiceModal(info, index) {
            currentLandIndex = index;
            document.getElementById('modal-title').innerText = info.name;
            document.getElementById('modal-desc').innerText = info.desc;
            document.getElementById('modal-overlay').style.display = 'flex';
        }

        function makeChoice(isDevelop) {
            document.getElementById('modal-overlay').style.display = 'none';
            const player = players[currentPlayerIdx];

            if (isDevelop) {
                // ê°œë°œ ì„ íƒ: ë•… ì°¨ì§€, ì ìˆ˜ íšë“
                boardState[currentLandIndex] = player.id;
                player.score++;
                player.lands.push(mapData[currentLandIndex].name);
                
                // íƒ€ì¼ ì‹œê°ì  ë³€ê²½ (ê°œë°œë¨)
                const tile = document.getElementById(`tile-${currentLandIndex}`);
                tile.style.backgroundColor = player.color;
                tile.style.color = "#000";
                tile.innerHTML += "<br>ğŸš§ê°œë°œë¨";
                tile.classList.add('occupied');
            } else {
                // ë³´ì¡´ ì„ íƒ: ì•„ë¬´ ì¼ë„ ì—†ìŒ
                // alert("ìì—°ì„ ì§€ì¼°ì§€ë§Œ ê²½ìŸì—ì„œ ë’¤ì²˜ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            }
            
            updateScoreBoard();
            nextTurn();
        }

        // --- í„´ ë„˜ê¸°ê¸° ---
        function nextTurn() {
            currentPlayerIdx++;
            if (currentPlayerIdx >= 4) {
                currentPlayerIdx = 0;
                currentTurn++;
            }
            totalTurnsPlayed++;

            // ê²Œì„ ì¢…ë£Œ ì¡°ê±´ í™•ì¸
            if (totalTurnsPlayed >= 4 * maxTurns) {
                endGame();
                return;
            }

            // UI ì—…ë°ì´íŠ¸
            document.getElementById('turn-info').innerText = 
                `í”Œë ˆì´ì–´ ${players[currentPlayerIdx].id}ì˜ ì°¨ë¡€ (ë¼ìš´ë“œ: ${currentTurn}/${maxTurns})`;
            document.getElementById('roll-btn').disabled = false;
            document.getElementById('dice-result').innerText = `ğŸ² ëŒ€ê¸° ì¤‘...`;
        }

        // --- ì—”ë”© ---
        function endGame() {
            const endingScreen = document.getElementById('ending-screen');
            const winner = players.reduce((prev, current) => (prev.score > current.score) ? prev : current);
            
            // ëª¨ë“  í”Œë ˆì´ì–´ê°€ ê°œë°œí•œ ë•…ì˜ ëª©ë¡
            const allDestroyedLands = players.flatMap(p => p.lands);
            const destructionCount = allDestroyedLands.length;

            endingScreen.style.display = 'flex';
            
            let message = `
                <strong style="font-size:30px; color:${winner.color}">ìš°ìŠ¹ì: ${winner.name}</strong><br>
                (ì°¨ì§€í•œ ë•…: ${winner.score}ê³³)<br><br>
                <hr style="border-color:#555; width:50%;">
                <br>
                ë‹¹ì‹ ë“¤ì´ ê²½ìŸí•˜ëŠ” ë™ì•ˆ...<br><br>
            `;

            if (destructionCount === 0) {
                message += "ë†€ëê²Œë„ ì•„ë¬´ë„ ê°œë°œì„ í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì§€êµ¬ëŠ” ì•ˆì „í•©ë‹ˆë‹¤.<br>í•˜ì§€ë§Œ ê²Œì„ì€ ì¬ë¯¸ì—†ì—ˆì£ ? ê·¸ê²Œ ë°”ë¡œ ì§€ì†ê°€ëŠ¥í•œ ì‚¶ì…ë‹ˆë‹¤.";
            } else {
                message += `
                    <span style="color:red; font-size:24px;">ë‹¤ìŒ ì§€ì—­ë“¤ì´ ì˜êµ¬ì ìœ¼ë¡œ íŒŒê´´ë˜ì—ˆìŠµë‹ˆë‹¤:</span><br><br>
                    ${allDestroyedLands.join(', ')}...<br><br>
                    ì•„ë§ˆì¡´ì€ ë¶ˆíƒ”ê³ , ë¹™í•˜ëŠ” ë…¹ì•˜ìœ¼ë©°, ë™ë¬¼ë“¤ì€ ê°ˆ ê³³ì„ ìƒì—ˆìŠµë‹ˆë‹¤.<br>
                    ë‹¹ì‹ ì€ ê²Œì„ì—ì„œ ì´ê²¼ì§€ë§Œ, <span style="color:red; font-weight:bold;">ìš°ë¦¬ê°€ ì‚´ ê³³ì€ ì´ì œ ì—†ìŠµë‹ˆë‹¤.</span>
                `;
            }

            document.getElementById('ending-message').innerHTML = message;
        }

        // ì‹œì‘
        initGame();

    </script>
</body>
</html>
